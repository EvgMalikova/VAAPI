<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>VAAPI: Tutorial: FRep basics</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">VAAPI
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Tutorial: FRep basics </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This tutorial demonstrates basics of geometry creation according to <a href="http://hyperfun.org/wiki/doku.php?id=frep:what">FRep modelling approach</a>. At the same time tutorial demonstrates the basics of API use and main concept that is much simillar to <a href="http://vtk.org">Visualisation Toolkit</a>. For similarities and differences with VTK see <a class="el" href="md_doc_vtkstyle.html">Main logic and similarities with VTK API</a></p>
<h1><a class="anchor" id="autotoc_md5"></a>
FRep primitive creation and rendering</h1>
<p>Below is simple program, creating SDF box primitive. Simillar to VTK API, the Camera, Renderer, GLFW Window and Interactor to process interactive manipulations with scene are created. For syntacsis comparison with simple VTK primitive creation look <a href="https://vtk.org/Wiki/VTK/Examples/Cxx/GeometricObjects/Cylinder">wiki</a>:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;vaWindow.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;sdfPrimitives.h&quot;</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])</div>
<div class="line">{</div>
<div class="line">  <span class="keywordtype">int</span>  windowWidth  = 512;</div>
<div class="line">  <span class="keywordtype">int</span>  windowHeight = 512;</div>
<div class="line">  </div>
<div class="line">  PinholeCamera pinholeCamera; <span class="comment">//creates basic camera</span></div>
<div class="line"> </div>
<div class="line">  contextManager m;</div>
<div class="line">  m.Update();<span class="comment">//creates context</span></div>
<div class="line"> </div>
<div class="line">  vaRenderer ren;</div>
<div class="line">  ren.SetValid(m.GetValid());</div>
<div class="line">  ren.SetContext(m.GetOutput());<span class="comment">//m returns the context</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  ren.SetOpticalDims(windowWidth, windowWidth);</div>
<div class="line">  ren.SetCamera(&amp;pinholeCamera);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//set not dynamic</span></div>
<div class="line">  ren.SetDynamic(<span class="keyword">false</span>);</div>
<div class="line">  ren.SetAuditory(<span class="keyword">false</span>);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//window procedure</span></div>
<div class="line"> </div>
<div class="line">  vaWindow optixWindowProc; </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line">  optixWindowProc.SetDim(windowWidth, windowHeight);</div>
<div class="line">  optixWindowProc.SetRenderer(&amp;ren);</div>
<div class="line">  optixWindowProc.SetContext(m.GetOutput()); </div>
<div class="line">  optixWindowProc.SetCamera(&amp;pinholeCamera);</div>
<div class="line"> </div>
<div class="line">  vaRenderWindowInteractor iren; <span class="comment">//TODO always check that basic still works</span></div>
<div class="line">  iren.SetWindow(&amp;optixWindowProc);</div>
<div class="line">  </div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;DONE WITH WINDOW&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  <span class="keywordflow">if</span> (iren.SetUp()) <span class="comment">//update of WindowProc is successful, we can start scene creation with predefined rendering parameters</span></div>
<div class="line">  {</div>
<div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;START MAIN LOOP&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">      <span class="comment">//Scene creation</span></div>
<div class="line">      <span class="keywordflow">try</span></div>
<div class="line">      {</div>
<div class="line">          </div>
<div class="line"> </div>
<div class="line">          </div>
<div class="line">          sdfBox sdf;</div>
<div class="line">          sdf.SetContext(m.GetOutput());</div>
<div class="line">          sdf.SetCenter1(optix::make_float3(0));</div>
<div class="line">          sdf.SetDims(optix::make_float3(0.3,1.0,3.0));</div>
<div class="line">          sdf.Update();</div>
<div class="line">          std::cout &lt;&lt; <span class="stringliteral">&quot;BOX created&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">          vaBasicMaterial mSdf;</div>
<div class="line">          mSdf.SetContext(m.GetOutput());</div>
<div class="line">          mSdf.Update();</div>
<div class="line">          std::cout &lt;&lt; <span class="stringliteral">&quot;MATERIAL created&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">          <a class="code" href="classva_mapper.html">vaMapper</a> map21;</div>
<div class="line">          map21.<a class="code" href="classva_basic_object.html#a084579231006f44f03b6834e723316b6">SetContext</a>(m.GetOutput());</div>
<div class="line">          map21.<a class="code" href="classva_mapper.html#a778f09202a3f15a52170f3ad433612f8">SetInput</a>(sdf.GetOutput());</div>
<div class="line">          map21.<a class="code" href="classva_mapper.html#aea3ef068acdb6b1b86f7b5ff8b8e38e2">AddMaterial</a>(mSdf.GetOutput(), mSdf.GetType());</div>
<div class="line">          map21.<a class="code" href="classva_mapper.html#a840064e5c0c1af154d46cdd9ec4f19ca">Update</a>();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">          <a class="code" href="classva_actor.html">vaActor</a> acSdf1;</div>
<div class="line">          acSdf1.<a class="code" href="classva_basic_actor.html#af3c54b025cbceb8e1ffffcf8b7b4327b">SetContext</a>(m.GetOutput());</div>
<div class="line">          acSdf1.<a class="code" href="classva_basic_actor.html#a6fc2fc28aa7585768cf3b083224b0c3e">AddMapper</a>(&amp;map21);</div>
<div class="line">          acSdf1.<a class="code" href="classva_basic_actor.html#aaab78113ac80441c1cc774f187b1b385">Update</a>();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">          ren.AddActor(&amp;acSdf1);</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">catch</span> (optix::Exception&amp; e)</div>
<div class="line">      {</div>
<div class="line">          std::cerr &lt;&lt; e.getErrorString() &lt;&lt; std::endl;</div>
<div class="line">      }</div>
<div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;DONE WITH SCENE&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">      <span class="comment">//Main loop</span></div>
<div class="line">      iren.Start();</div>
<div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;MAIN LOOP STARTED&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><p>The output of the program is:</p>
<div class="image">
<img src="box.png" alt=""/>
<div class="caption">
Rendered SDF box</div></div>
   <p>A more complex example is below:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;vaWindow.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;sdfPrimitives.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;sdfOperations.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])</div>
<div class="line">{</div>
<div class="line">  <span class="keywordtype">int</span>  windowWidth  = 512;</div>
<div class="line">  <span class="keywordtype">int</span>  windowHeight = 512;</div>
<div class="line">  </div>
<div class="line">  PinholeCamera pinholeCamera; <span class="comment">//creates basic camera</span></div>
<div class="line"> </div>
<div class="line">  contextManager m;</div>
<div class="line">  m.Update();<span class="comment">//creates context</span></div>
<div class="line"> </div>
<div class="line">  vaRenderer ren;</div>
<div class="line">  ren.SetValid(m.GetValid());</div>
<div class="line">  ren.SetContext(m.GetOutput());</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  ren.SetOpticalDims(windowWidth, windowWidth);</div>
<div class="line">  ren.SetCamera(&amp;pinholeCamera);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//set not dynamic</span></div>
<div class="line">  ren.SetDynamic(<span class="keyword">false</span>);</div>
<div class="line">  ren.SetAuditory(<span class="keyword">false</span>);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">//window procedure</span></div>
<div class="line"> </div>
<div class="line">  vaWindow optixWindowProc; </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line">  optixWindowProc.SetDim(windowWidth, windowHeight);</div>
<div class="line">  optixWindowProc.SetRenderer(&amp;ren);</div>
<div class="line">  optixWindowProc.SetContext(m.GetOutput()); <span class="comment">//returns context</span></div>
<div class="line">  optixWindowProc.SetCamera(&amp;pinholeCamera);</div>
<div class="line"> </div>
<div class="line">  vaRenderWindowInteractor iren; <span class="comment">//TODO always check that basic still works</span></div>
<div class="line">  iren.SetWindow(&amp;optixWindowProc);</div>
<div class="line">  </div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;DONE WITH WINDOW&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  <span class="keywordflow">if</span> (iren.SetUp()) <span class="comment">//update of WindowProc</span></div>
<div class="line">  {</div>
<div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;START MAIN LOOP&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">      <span class="comment">//Scene creation</span></div>
<div class="line">      <span class="keywordflow">try</span></div>
<div class="line">      {</div>
<div class="line">          </div>
<div class="line"> </div>
<div class="line">          </div>
<div class="line">          sdfBox sdf;</div>
<div class="line">          sdf.SetContext(m.GetOutput());</div>
<div class="line">          sdf.SetCenter1(optix::make_float3(1.0));</div>
<div class="line">          sdf.SetDims(optix::make_float3(0.3));</div>
<div class="line">          sdf.Update();</div>
<div class="line">          <span class="keyword">const</span> <span class="keywordtype">int</span> nums = 10;</div>
<div class="line">          sdfRoundingOp round[nums];</div>
<div class="line">          round[0].SetContext(m.GetOutput());</div>
<div class="line">          round[0].AddOpperand(&amp;sdf);</div>
<div class="line">          round[0].SetKoeff(0.01);</div>
<div class="line">          round[0].Update();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; nums; i++)</div>
<div class="line">          {</div>
<div class="line"> </div>
<div class="line">              round[i].SetContext(m.GetOutput());</div>
<div class="line"> </div>
<div class="line">              round[i].AddOpperand(round[i - 1].GetOutputSdfObject());<span class="comment">// &amp;sdf);</span></div>
<div class="line">              round[i].SetKoeff(0.01*i);</div>
<div class="line">              round[i].Update();</div>
<div class="line"> </div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">          sdfTorus sdfT;</div>
<div class="line">          sdfT.SetContext(m.GetOutput());</div>
<div class="line">          sdfT.SetCenter1(optix::make_float3(0.0));</div>
<div class="line">          sdfT.SetRadius1(optix::make_float2(0.4, 0.1));</div>
<div class="line">          sdfT.Update();</div>
<div class="line"> </div>
<div class="line">          SDFElongateOp el;</div>
<div class="line"> </div>
<div class="line">          el.SetContext(m.GetOutput());</div>
<div class="line">          el.AddOpperand(&amp;sdfT);</div>
<div class="line">          el.SetHKoeff(optix::make_float3(0.0, 1.0, 2.1));</div>
<div class="line">          el.Update();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">          sdfBlendUnionOp opBlend;</div>
<div class="line">          opBlend.SetContext(m.GetOutput());</div>
<div class="line">          opBlend.AddOpperand1(&amp;sdf);</div>
<div class="line">          opBlend.AddOpperand2(el.GetOutputSdfObject());</div>
<div class="line">          opBlend.SetKoeff(0.3);</div>
<div class="line">          opBlend.Update();</div>
<div class="line">          </div>
<div class="line"> </div>
<div class="line">          vaBasicMaterial mSdf;</div>
<div class="line">          mSdf.SetContext(m.GetOutput());</div>
<div class="line">          mSdf.Update();</div>
<div class="line"> </div>
<div class="line">          <a class="code" href="classva_mapper.html">vaMapper</a> map21;</div>
<div class="line">          map21.<a class="code" href="classva_basic_object.html#a084579231006f44f03b6834e723316b6">SetContext</a>(m.GetOutput());</div>
<div class="line">          map21.<a class="code" href="classva_mapper.html#a778f09202a3f15a52170f3ad433612f8">SetInput</a>(sdf.GetOutput());</div>
<div class="line">          map21.<a class="code" href="classva_mapper.html#aea3ef068acdb6b1b86f7b5ff8b8e38e2">AddMaterial</a>(mSdf.GetOutput(), mSdf.GetType());</div>
<div class="line">          map21.<a class="code" href="classva_mapper.html#a840064e5c0c1af154d46cdd9ec4f19ca">Update</a>();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">          <a class="code" href="classva_actor.html">vaActor</a> acSdf1;</div>
<div class="line">          acSdf1.<a class="code" href="classva_basic_actor.html#af3c54b025cbceb8e1ffffcf8b7b4327b">SetContext</a>(m.GetOutput());</div>
<div class="line">          acSdf1.<a class="code" href="classva_basic_actor.html#a6fc2fc28aa7585768cf3b083224b0c3e">AddMapper</a>(&amp;map21);</div>
<div class="line">          acSdf1.<a class="code" href="classva_basic_actor.html#aaab78113ac80441c1cc774f187b1b385">Update</a>();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">          ren.AddActor(&amp;acSdf1);</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">catch</span> (optix::Exception&amp; e)</div>
<div class="line">      {</div>
<div class="line">          std::cerr &lt;&lt; e.getErrorString() &lt;&lt; std::endl;</div>
<div class="line">      }</div>
<div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;DONE WITH SCENE&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">      <span class="comment">//Main loop</span></div>
<div class="line">      iren.Start();</div>
<div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;MAIN LOOP STARTED&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><p>The output of the program is :</p>
<div class="image">
<img src="blend.png" alt=""/>
<div class="caption">
Rendered FRep modelled geometry</div></div>
    </div></div><!-- contents -->
</div><!-- PageDoc -->
<div class="ttc" id="aclassva_mapper_html_a840064e5c0c1af154d46cdd9ec4f19ca"><div class="ttname"><a href="classva_mapper.html#a840064e5c0c1af154d46cdd9ec4f19ca">vaMapper::Update</a></div><div class="ttdeci">virtual void Update()</div><div class="ttdef"><b>Definition:</b> optixAbstractMaterial.cpp:117</div></div>
<div class="ttc" id="aclassva_actor_html"><div class="ttname"><a href="classva_actor.html">vaActor</a></div><div class="ttdef"><b>Definition:</b> vaActor.h:48</div></div>
<div class="ttc" id="aclassva_mapper_html"><div class="ttname"><a href="classva_mapper.html">vaMapper</a></div><div class="ttdoc">A basic mapper that suggest application of one visual and one auditory material to one geometry insta...</div><div class="ttdef"><b>Definition:</b> optixAbstractMaterial.h:168</div></div>
<div class="ttc" id="aclassva_basic_object_html_a084579231006f44f03b6834e723316b6"><div class="ttname"><a href="classva_basic_object.html#a084579231006f44f03b6834e723316b6">vaBasicObject::SetContext</a></div><div class="ttdeci">virtual void SetContext(optix::Context &amp;context)</div><div class="ttdef"><b>Definition:</b> vaBasicObject.h:26</div></div>
<div class="ttc" id="aclassva_basic_actor_html_aaab78113ac80441c1cc774f187b1b385"><div class="ttname"><a href="classva_basic_actor.html#aaab78113ac80441c1cc774f187b1b385">vaBasicActor::Update</a></div><div class="ttdeci">void Update()</div><div class="ttdef"><b>Definition:</b> optixBasicActor.cpp:9</div></div>
<div class="ttc" id="aclassva_basic_actor_html_af3c54b025cbceb8e1ffffcf8b7b4327b"><div class="ttname"><a href="classva_basic_actor.html#af3c54b025cbceb8e1ffffcf8b7b4327b">vaBasicActor::SetContext</a></div><div class="ttdeci">virtual void SetContext(optix::Context &amp;context)</div><div class="ttdef"><b>Definition:</b> optixBasicActor.h:46</div></div>
<div class="ttc" id="aclassva_basic_actor_html_a6fc2fc28aa7585768cf3b083224b0c3e"><div class="ttname"><a href="classva_basic_actor.html#a6fc2fc28aa7585768cf3b083224b0c3e">vaBasicActor::AddMapper</a></div><div class="ttdeci">void AddMapper(vaMapper *map)</div><div class="ttdef"><b>Definition:</b> optixBasicActor.h:51</div></div>
<div class="ttc" id="aclassva_mapper_html_a778f09202a3f15a52170f3ad433612f8"><div class="ttname"><a href="classva_mapper.html#a778f09202a3f15a52170f3ad433612f8">vaMapper::SetInput</a></div><div class="ttdeci">void SetInput(optix::Geometry g)</div><div class="ttdef"><b>Definition:</b> optixAbstractMaterial.h:173</div></div>
<div class="ttc" id="aclassva_mapper_html_aea3ef068acdb6b1b86f7b5ff8b8e38e2"><div class="ttname"><a href="classva_mapper.html#aea3ef068acdb6b1b86f7b5ff8b8e38e2">vaMapper::AddMaterial</a></div><div class="ttdeci">void AddMaterial(optix::Material m, MaterialDesc desc)</div><div class="ttdef"><b>Definition:</b> optixAbstractMaterial.cpp:168</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.16
</small></address>
</body>
</html>
